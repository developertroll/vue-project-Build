"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[161,787],{4301:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var o=a(3396),l=a(7139);const r={class:"dialogHeader"},n=["id"],s={class:"card-header"};function i(e,t,a,i,d,c){const p=(0,o.up)("el-button"),u=(0,o.up)("showMemberV2"),m=(0,o.up)("ShowAllocate"),h=(0,o.up)("el-date-picker"),f=(0,o.up)("el-card"),g=(0,o.up)("el-dialog");return(0,o.wg)(),(0,o.iD)(o.HY,null,[i.isCollapse?((0,o.wg)(),(0,o.j4)(p,{key:0,type:"primary",plain:"",onClick:c.openDialog},{default:(0,o.w5)((()=>[(0,o.Uk)("...")])),_:1},8,["onClick"])):((0,o.wg)(),(0,o.j4)(p,{key:1,type:"primary",plain:"",onClick:c.openDialog},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(c.form.title),1)])),_:1},8,["onClick"])),(0,o.Wm)(g,{modelValue:d.test,"onUpdate:modelValue":t[1]||(t[1]=e=>d.test=e),"append-to-body":""},{header:(0,o.w5)((({titleId:e,titleClass:t})=>[(0,o._)("div",r,[(0,o._)("h2",{id:e,class:(0,l.C_)(t)},(0,l.zw)(c.form.title),11,n)])])),default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(c.form,((e,a,r)=>((0,o.wg)(),(0,o.j4)(f,{border:"",key:r,class:"card"},{header:(0,o.w5)((()=>[(0,o._)("div",s,(0,l.zw)(d.translateKey[a]),1)])),default:(0,o.w5)((()=>[Array.isArray(e)&&"date1"!==a?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},["Partipacants"===a?((0,o.wg)(),(0,o.j4)(u,{key:0,parentData:e},null,8,["parentData"])):((0,o.wg)(),(0,o.j4)(m,{key:1,project:c.form},null,8,["project"]))],64)):"date1"===a?((0,o.wg)(),(0,o.j4)(h,{key:1,modelValue:c.form.date1,"onUpdate:modelValue":t[0]||(t[0]=e=>c.form.date1=e),type:"daterange","range-separator":"~","start-placeholder":"Start date","end-placeholder":"End date",readonly:""},null,8,["modelValue"])):((0,o.wg)(),(0,o.iD)(o.HY,{key:2},[(0,o.Uk)((0,l.zw)(e),1)],64))])),_:2},1024)))),128))])),_:1},8,["modelValue"])],64)}var d=a(2616),c=a(5086),p=a(970),u=a(5680),m=a(2750),h={name:"DocumentedProject",components:{showMemberV2:u["default"],ShowAllocate:m["default"]},setup(){const{type:e}=(0,p.Z)(),t=(0,o.Fl)((()=>"sm"===e.value));return{isCollapse:t}},data(){return{test:!1,Hello:"Hello",ApprovalList:d.e,data:{title:"",date1:[],works:[],desc:"",Partipacants:[],update:""},translateKey:{title:"제목",date1:"진행 날짜",works:"업무",desc:"내용",Partipacants:"참가 인원",update:"날짜 업데이트",type:"종류",status:"결재 상태",writer:"작성자",master:"결재자"}}},props:{project:{type:Object,default:()=>{}}},methods:{openDialog(){this.test=!0,console.log(this.project,"project"),console.log(this.form,"form")}},computed:{form(){try{let e;if(this.project&&this.project.type)e="수정"===this.project.status?this.project:d.e.findList(this.project.title),console.log(e);else if(this.project&&this.project.title){let{work:t,project:a}=c.b.findWorkAndProject(this.project.title);e={...a,works:t},delete e.index,console.log(e)}return e}catch(e){return console.log(e),this.data}}},watch:{project:{handler(){console.log(this.project,"project")}}}},f=a(89);const g=(0,f.Z)(h,[["render",i],["__scopeId","data-v-7cf8bf35"]]);var w=g},6595:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var o=a(3396);const l=e=>((0,o.dD)("data-v-d4f8592c"),e=e(),(0,o.Cn)(),e),r=l((()=>(0,o._)("div",null," 업무 할당을 시작하기 위해선 모든 정보를 입력해야 하고, 해당 정보를 다시 입력하기 위해선 업무 할당을 초기화해야 합니다. 이 프로젝트의 결재는 지정한 인원에서 가장 높은 직급의 사람이 결재를 하게 됩니다. ",-1))),n={class:"center"},s={key:1},i=l((()=>(0,o._)("h4",null," 최소 프로젝트 참가 인원 전원이 1개 이상의 업무가 할당되어야 합니다. 수정 후 저장 버튼을 누르면 계획안을 제출 할 수 있습니다. ",-1))),d={class:"center"};function c(e,t,a,l,c,p){const u=(0,o.up)("el-input"),m=(0,o.up)("el-form-item"),h=(0,o.up)("el-divider"),f=(0,o.up)("el-date-picker"),g=(0,o.up)("addMemberV2"),w=(0,o.up)("showMemberV2"),k=(0,o.up)("el-alert"),P=(0,o.up)("el-button"),y=(0,o.up)("AllocateWorkV2"),b=(0,o.up)("el-form");return(0,o.wg)(),(0,o.j4)(b,{model:c.form,"label-width":"120px","label-position":"left","status-icon":"",rules:c.rules},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{label:"제목",prop:"title"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{modelValue:c.form.title,"onUpdate:modelValue":t[0]||(t[0]=e=>c.form.title=e),disabled:c.PassWork},null,8,["modelValue","disabled"])])),_:1}),(0,o.Wm)(h),(0,o.Wm)(m,{label:"진행 날짜",prop:"date1"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{modelValue:c.form.date1,"onUpdate:modelValue":t[1]||(t[1]=e=>c.form.date1=e),type:"daterange","range-separator":"~","start-placeholder":"Start date","end-placeholder":"End date","value-format":"YYYY-MM-DD",format:"YYYY/MM/DD",clearable:!c.PassWork,disabled:c.PassWork},null,8,["modelValue","clearable","disabled"])])),_:1}),(0,o.Wm)(h),(0,o.Wm)(m,{label:"내용",prop:"desc"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{modelValue:c.form.desc,"onUpdate:modelValue":t[2]||(t[2]=e=>c.form.desc=e),type:"textarea",disabled:c.PassWork,autosize:""},null,8,["modelValue","disabled"])])),_:1}),(0,o.Wm)(h),(0,o.Wm)(m,{label:"참가 인원",prop:"Partipacants"},{default:(0,o.w5)((()=>[c.PassWork?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(g,{key:0,onSavePart:p.savePart,parentData:c.form.Partipacants},null,8,["onSavePart","parentData"])),(0,o.Wm)(w,{parentData:c.form.Partipacants},null,8,["parentData"])])),_:1}),c.PassWork?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(k,{key:0,type:"warning","show-icon":"",closable:!1},{default:(0,o.w5)((()=>[r])),_:1})),(0,o._)("div",n,[c.PassWork?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(m,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(P,{type:"primary",onClick:p.openWork},{default:(0,o.w5)((()=>[(0,o.Uk)("업무 할당하기")])),_:1},8,["onClick"])])),_:1}))]),c.PassWork?((0,o.wg)(),(0,o.iD)("div",s,[p.AllDataSaved?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(k,{key:0,type:"warning","show-icon":"",closable:!1},{default:(0,o.w5)((()=>[i])),_:1})),(0,o.Wm)(m,{label:"업무 할당"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{Parti:c.form.Partipacants,onSaveWorks:p.saveWork,parentDate:c.form.date1,onCommitEdit:p.changeCommit},null,8,["Parti","onSaveWorks","parentDate","onCommitEdit"])])),_:1}),(0,o.Wm)(h),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o._)("div",d,[(0,o.Wm)(P,{type:"primary",onClick:p.onSubmit,disabled:!p.AllDataSaved},{default:(0,o.w5)((()=>[(0,o.Uk)("완성")])),_:1},8,["onClick","disabled"]),(0,o.Wm)(P,{type:"warning",onClick:p.cancelAllocate},{default:(0,o.w5)((()=>[(0,o.Uk)("할당 취소")])),_:1},8,["onClick"])])])),_:1})])):(0,o.kq)("",!0)])),_:1},8,["model","rules"])}var p=a(9545),u=a(5680),m=a(782),h=a(5086),f=a(6e3),g=a(6797),w=a.n(g),k=a(2616),P={name:"createPlan",components:{addMemberV2:p["default"],showMemberV2:u["default"],AllocateWorkV2:m["default"]},emits:["savePlan"],data(){return{form:{title:"",date1:[],works:[],desc:"",Partipacants:[],update:""},ApprovalList:k.e,rules:{title:[{required:!0,message:"프로젝트 제목을 작성해주세요",trigger:"blur"}],date1:[{required:!0,message:"프로젝트 기간을 입력해주세요",trigger:"change"}],desc:[{required:!0,message:"설명을 입력해주세요",trigger:"blur"}]},projectPlanList:h.b,PassWork:!1,Committed:!1}},computed:{AllDataSaved(){return this.form.works.length>=this.form.Partipacants.length&&this.Committed},hasInput(){return this.projectData!==this.form&&void 0!==this.projectData&&null!==this.projectData}},methods:{onSubmit(){this.$message({type:"success",message:"프로젝트 계획이 작성되었습니다. 승인이 끝나면 프로젝트가 시작됩니다."}),console.log("submit!"),console.log(this.form),this.form.update=w()().format("YYYY-MM-DD"),this.ApprovalList.request(this.form,"계획","요청"),console.log(this.projectPlanList.List),this.$emit("savePlan")},savePart(e){this.form.Partipacants=e},saveWork(e){this.form.works=e,console.log("saveWork!",e,this.form.works)},openWork(){""!=this.form.title&&this.form.date1!=[]&&this.form.Partipacants!=[]?(this.$message({type:"info",message:"업무 할당을 시작합니다"}),this.PassWork=!0):this.$message({type:"warning",message:"프로젝트 정보가 모두 작성되여야 합니다"})},cancelAllocate(){f.T.confirm("업무 할당을 취소하고 기본 정보 작성으로 돌아갑니다. 계속하시겠습니까?","경고",{confirmButtonText:"확인",cancelButtonText:"취소",type:"warning"}).then((()=>{this.PassWork=!1,this.form.works=[],this.$message({type:"info",message:"업무 할당이 취소되었습니다"})})).catch((()=>{this.$message({type:"info",message:"업무 할당을 계속합니다"})}))},changeCommit(e){this.Committed=e}}},y=a(89);const b=(0,y.Z)(P,[["render",c],["__scopeId","data-v-d4f8592c"]]);var j=b},2427:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var o=a(3396);const l={key:0},r={key:1};function n(e,t,a,n,s,i){const d=(0,o.up)("showPlan"),c=(0,o.up)("createPlan"),p=(0,o.up)("modifyPlan");return s.currentProject?((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(d,{onCreatePlan:i.change,onModifyPlan:i.change2,projectPlan:"예정"},null,8,["onCreatePlan","onModifyPlan"])])):((0,o.wg)(),(0,o.iD)("div",r,[0===Object.keys(s.parentData).length?((0,o.wg)(),(0,o.j4)(c,{key:0,onSavePlan:i.change},null,8,["onSavePlan"])):((0,o.wg)(),(0,o.j4)(p,{key:1,onSavePlan:i.change,projectData:i.insertData},null,8,["onSavePlan","projectData"]))]))}var s=a(8068),i=a(6595),d=a(5086),c=a(7999),p={name:"projectPlan",components:{showPlan:s["default"],createPlan:i["default"],modifyPlan:c["default"]},data(){return{currentProject:!0,parentData:{}}},methods:{change(){this.currentProject=!this.currentProject},change2(e){this.parentData=d.b.List.find((t=>t.title===e.title)),console.log(this.parentData),this.currentProject=!this.currentProject}},computed:{insertData(){return this.parentData}}},u=a(89);const m=(0,u.Z)(p,[["render",n],["__scopeId","data-v-75699b8f"]]);var h=m},8068:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var o=a(3396);const l={key:0,class:"buttons"};function r(e,t,a,r,n,s){const i=(0,o.up)("el-button"),d=(0,o.up)("el-tooltip"),c=(0,o.up)("el-table-column"),p=(0,o.up)("DocumentedProjectV2"),u=(0,o.up)("el-table");return(0,o.wg)(),(0,o.iD)(o.HY,null,["예정"===a.projectPlan?((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(i,{type:"primary",onClick:s.createPlan},{default:(0,o.w5)((()=>[(0,o.Uk)("생성")])),_:1},8,["onClick"]),(0,o.Wm)(d,{disabled:!s.multiCheck,content:s.modifyButton,placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{type:"warning",disabled:s.multiCheck,onClick:s.modifyPlan},{default:(0,o.w5)((()=>[(0,o.Uk)("수정")])),_:1},8,["disabled","onClick"])])),_:1},8,["disabled","content"]),(0,o.Wm)(d,{disabled:!s.onGoingCheck,content:"이미 진행중인 프로젝트의 삭제는 불가능합니다. 삭제를 원할 시 관리자에게 연락해주세요",placement:"top"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{type:"danger",disabled:s.onGoingCheck,onClick:s.deletePlan},{default:(0,o.w5)((()=>[(0,o.Uk)("삭제")])),_:1},8,["disabled","onClick"])])),_:1},8,["disabled"])])):(0,o.kq)("",!0),(0,o.Wm)(u,{data:s.PlanList,border:"",style:{width:"100%"},onSelectionChange:s.handleSelect},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{type:"selection",width:"55"}),(0,o.Wm)(c,{prop:"title",label:"제목"},{default:(0,o.w5)((e=>[(0,o.Wm)(p,{project:e.row},null,8,["project"])])),_:1}),(0,o.Wm)(c,{prop:"desc",label:"설명"}),(0,o.Wm)(c,{prop:"member",label:"참가인원","show-overflow-tooltip":""}),(0,o.Wm)(c,{prop:"status",label:"상태"}),(0,o.Wm)(c,{prop:"startDate",label:"시작일"})])),_:1},8,["data","onSelectionChange"])],64)}var n=a(5086),s=a(6797),i=a.n(s),d=a(6e3),c=a(4301),p={name:"projectPlan",emits:["createPlan","modifyPlan","deletePlan"],components:{DocumentedProjectV2:c["default"]},props:{projectPlan:{type:String,default:"예정",validator:e=>["예정","진행","완료"].includes(e)}},data(){return{currentProject:null,tableData:[],projectPlanList:n.b,selectedRow:[],modifyToolTip:["이미 진행중인 프로젝트는 수정할 수 없습니다. 수정이 필요하면 관리자에게 연락해주세요","2개 이상의 프로젝트를 선택하면 수정 할 수 없습니다","이미 진행중인 프로젝트는 수정할 수 없습니다, 수정은 1개의 프로젝트만 선택해야합니다"]}},computed:{PlanList(){const e=this.projectPlanList.callPlanList(),t=e.filter((e=>{const t=i()(e.date1[0]),a=i()(),o=a.diff(t,"days"),l="완료"===e.status?"완료":o<0?"진행예정":e.status;return("완료"!==this.projectPlan||"완료"===l)&&("진행"!==this.projectPlan||"진행예정"===l)}));return t.map((e=>{const t=e.Partipacants.map((e=>e.name)).join(", "),a=i()(e.date1[0]),o=i()(),l=o.diff(a,"days"),r="완료"===e.status?"완료":l<0?"진행예정":e.status;return{title:e.title,desc:e.desc,member:t,status:r,startDate:e.date1[0]}}))},multiCheck(){return this.onGoingCheck||this.selectedRow.length>1},onGoingCheck(){return this.selectedRow.some((e=>"진행예정"!==e.status))&&this.selectedRow.length>0},modifyButton(){return this.selectedRow.length>1&&this.onGoingCheck?this.modifyToolTip[2]:this.selectedRow.length>1?this.modifyToolTip[1]:this.onGoingCheck?this.modifyToolTip[0]:"완료"}},methods:{createPlan(){this.$emit("createPlan")},handleSelect(e){this.selectedRow=e},modifyPlan(){this.$emit("modifyPlan",this.selectedRow[0])},deletePlan(){d.T.confirm("선택된 프로젝트 계획들을 취소하시겠습니까?","경고",{confirmButtonText:"승인",cancelButtonText:"취소",type:"warning"}).then((()=>{for(const e of this.selectedRow){console.log(e);const t=this.projectPlanList.List.find((t=>t.title===e.title));console.log(t),this.projectPlanList.deletePlanWork(t)}this.$message({type:"success",message:"취소되었습니다"})})).catch((()=>this.$message({type:"info",message:"취소되었습니다"})))}}},u=a(89);const m=(0,u.Z)(p,[["render",r],["__scopeId","data-v-02bc7f14"]]);var h=m}}]);
//# sourceMappingURL=161.0859b149.js.map